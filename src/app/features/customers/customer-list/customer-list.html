<div class="p-4">
  <!-- Top Bar -->
  <div class="flex justify-between items-center mb-3">
    <!-- Search -->
    <div class="w-1/3">
      <input 
        pInputText 
        type="text" 
        placeholder="Search customer..."
        class="w-full p-2 border rounded-md"
        (input)="dt.filterGlobal($event.target.value, 'contains')" />
    </div>

    <!-- Add Button -->
    <button 
      class="px-4 py-2 rounded-lg text-white font-medium shadow-md 
             bg-gradient-to-r from-blue-600 to-indigo-500 hover:opacity-90 flex items-center gap-2"
      (click)="openDialog()">
      <i class="pi pi-plus"></i>
      Add Customer
    </button>
  </div>

  <!-- Table -->
  <div class="border rounded-2xl shadow-md overflow-hidden">
    <p-table #dt 
         [value]="customers" 
         [loading]="loading"
         [paginator]="true"
         [rows]="rows"
         
         [first]="first"
         [totalRecords]="totalRecords"
         [rowsPerPageOptions]="[10, 20, 30]"
         (onPage)="onPageChange($event)"
         class="w-full"
         [globalFilterFields]="['name','phone','email','address','notes']">

      <!-- Header -->
      <ng-template pTemplate="header">
        <tr class="bg-gradient-to-r from-blue-600 to-indigo-500 text-white">
          <th pSortableColumn="name" class="px-3 py-2">
            Name <p-sortIcon field="name"></p-sortIcon>
          </th>
          <th class="px-3 py-2">Phone</th>
          <th class="px-3 py-2">Email</th>
          <th class="px-3 py-2">Address</th>
          <th class="px-3 py-2">Notes</th>
          <th class="px-3 py-2">Created At</th>
          <th class="px-3 py-2">Updated At</th>
          <th class="px-3 py-2 text-center">Actions</th>
        </tr>
      </ng-template>

      <!-- Body -->
      <ng-template pTemplate="body" let-cust>
        <tr>
          <td class="px-3 py-2">{{ cust.name }}</td>
          <td class="px-3 py-2">{{ cust.phone }}</td>
          <td class="px-3 py-2">{{ cust.email }}</td>
          <td class="px-3 py-2">{{ cust.address }}</td>
          <td class="px-3 py-2">{{ cust.notes }}</td>
          <td class="px-3 py-2">{{ cust.createdAt | date:'short' }}</td>
          <td class="px-3 py-2">{{ cust.updatedAt | date:'short' }}</td>
          <td class="text-center px-3 py-2 flex justify-center gap-2">
            <!-- Edit -->
            <button 
              class="px-2.5 py-1.5 rounded-md text-white shadow-sm 
         bg-gradient-to-r from-blue-600 to-indigo-500 hover:opacity-90
         flex items-center justify-center text-sm"
              (click)="editCustomer(cust)">
              <i class="pi pi-pencil"></i>
            </button>
            <!-- Delete -->
            <button 
              class="px-2.5 py-1.5 rounded-md text-white shadow-sm 
         bg-gradient-to-r from-red-500 to-pink-500 hover:opacity-90
         flex items-center justify-center text-sm"
              (click)="deleteCustomer(cust)">
              <i class="pi pi-trash"></i>
            </button>
          </td>
        </tr>
      </ng-template>
    </p-table>
  </div>

  <!-- Add/Edit Dialog -->
  <p-dialog [(visible)]="displayDialog" header="Customer" 
            [modal]="true" [closable]="true" [style]="{width: '35vw'}">
    <div class="flex flex-col gap-3">
      <input pInputText type="text" placeholder="Name" [(ngModel)]="newCustomer.name" class="w-full p-2 border rounded-md" />
      <input pInputText type="text" placeholder="Phone" [(ngModel)]="newCustomer.phone" class="w-full p-2 border rounded-md" />
      <input pInputText type="text" placeholder="Email" [(ngModel)]="newCustomer.email" class="w-full p-2 border rounded-md" />
      <input pInputText type="text" placeholder="Address" [(ngModel)]="newCustomer.address" class="w-full p-2 border rounded-md" />
      <textarea [(ngModel)]="newCustomer.notes" placeholder="Notes" class="w-full p-2 border rounded-md"></textarea>
    </div>
    <ng-template pTemplate="footer">
      <button 
        class="px-4 py-2 rounded-lg text-gray-600 font-medium border hover:bg-gray-100"
        (click)="displayDialog=false">
        <i class="pi pi-times mr-2"></i> Cancel
      </button>
      <button 
        class="px-4 py-2 rounded-lg text-white font-medium shadow-md 
               bg-gradient-to-r from-blue-600 to-indigo-500 hover:opacity-90"
        (click)="saveCustomer()">
        <i class="pi pi-check mr-2"></i> Save
      </button>
    </ng-template>
  </p-dialog>

  <!-- Confirm Dialog -->
  <p-confirmDialog></p-confirmDialog>
</div>
