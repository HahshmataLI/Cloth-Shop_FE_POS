<div class="p-4">
  <!-- Top Bar -->
  <div class="flex justify-between items-center mb-3">
    <!-- Search -->
    <div class="w-1/3">
      <input 
        pInputText 
        type="text" 
        placeholder="Search sales..."
        class="w-full p-2 border rounded-md"
        (input)="searchText = $event.target.value; applyFilter()" />
    </div>

    <!-- Add Sale -->
    <button 
      class="px-4 py-2 rounded-lg text-white font-medium shadow-md 
             bg-gradient-to-r from-blue-600 to-indigo-500 hover:opacity-90 flex items-center gap-2"
      routerLink="/add-sale">
      <i class="pi pi-plus"></i>
      Add Sale
    </button>
  </div>

  <!-- Sales Table -->
  <div class="border rounded-2xl shadow-md overflow-hidden">
    <p-table 
      [value]="filteredSales"
      [loading]="loading"
      [paginator]="true"
      [rows]="rows"
      [first]="first"
      [sortField]="'date'"    
      [sortOrder]="-1" 
      paginatorDropdownAppendTo="body"
      [rowsPerPageOptions]="[5,10,20]"
      (onPage)="onPageChange($event)"
      class="w-full">

      <!-- Header -->
    <ng-template pTemplate="header">
    <tr class="bg-gradient-to-r from-green-500 to-emerald-600 text-white">
      <th pSortableColumn="_id">
        Invoice # <p-sortIcon field="_id"></p-sortIcon>
      </th>
      <th pSortableColumn="customer.name">
        Customer <p-sortIcon field="customer.name"></p-sortIcon>
      </th>
      <th pSortableColumn="date">
        Date <p-sortIcon field="date"></p-sortIcon>
      </th>
      <th>Items</th>
      <th pSortableColumn="grandTotal">
        Total <p-sortIcon field="grandTotal"></p-sortIcon>
      </th>
      <th pSortableColumn="paymentMethod">
        Status <p-sortIcon field="paymentMethod"></p-sortIcon>
      </th>
      <th class="text-center">Actions</th>
    </tr>
  </ng-template>

      <!-- Body -->
      <ng-template pTemplate="body" let-sale>
        <tr>
          <td class="px-3 py-2">INV-{{ sale._id | slice:-6 }}</td>
          <td class="px-3 py-2">{{ sale.customer?.name }}</td>
          <td class="px-3 py-2">{{ sale.date | date:'short' }}</td>
          <td class="px-3 py-2">{{ sale.items?.length }}</td>
          <td class="px-3 py-2 font-semibold">{{ sale.grandTotal | currency:'PKR' }}</td>
          <td class="px-3 py-2">
            <span 
              class="px-2 py-1 rounded text-xs font-medium"
              [ngClass]="{
                'bg-green-100 text-green-700': sale.paymentMethod !== 'Credit',
                'bg-yellow-100 text-yellow-700': sale.paymentMethod === 'Credit'
              }">
              {{ sale.paymentMethod }}
            </span>
          </td>
         <td class="text-center px-3 py-2 flex justify-center gap-2">
  <!-- View Invoice -->
  <button 
    class="px-2.5 py-1.5 rounded-md text-white shadow-sm 
           bg-gradient-to-r from-gray-600 to-gray-800 hover:opacity-90
           flex items-center justify-center text-sm"
    (click)="viewInvoice(sale)">
    <i class="pi pi-eye"></i>
  </button>

  <!-- Print Invoice -->
  <button 
    class="px-2.5 py-1.5 rounded-md text-white shadow-sm 
           bg-gradient-to-r from-green-600 to-emerald-500 hover:opacity-90
           flex items-center justify-center text-sm"
    (click)="printInvoice(sale)">
    <i class="pi pi-print"></i>
  </button>

  <!-- Save PDF -->
  <button 
    class="px-2.5 py-1.5 rounded-md text-white shadow-sm 
           bg-gradient-to-r from-purple-600 to-pink-500 hover:opacity-90
           flex items-center justify-center text-sm"
    (click)="downloadPdf(sale)">
    <i class="pi pi-file-pdf"></i>
  </button>

  <!-- Edit -->
  <button 
    class="px-2.5 py-1.5 rounded-md text-white shadow-sm 
           bg-gradient-to-r from-blue-600 to-indigo-500 hover:opacity-90
           flex items-center justify-center text-sm"
    (click)="editSale(sale)">
    <i class="pi pi-pencil"></i>
  </button>

  <!-- Delete -->
  <button 
    class="px-2.5 py-1.5 rounded-md text-white shadow-sm 
           bg-gradient-to-r from-red-500 to-pink-500 hover:opacity-90
           flex items-center justify-center text-sm"
    (click)="confirmDelete(sale)">
    <i class="pi pi-trash"></i>
  </button>
</td>

        </tr>
      </ng-template>
    </p-table>
  </div>

  <!-- Confirm Dialog -->
  <p-confirmDialog></p-confirmDialog>
</div>
